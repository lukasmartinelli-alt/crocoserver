<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Hello React!</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/pure-min.css">
    <link rel="stylesheet" href="/css/crocoserver.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.8.23/browser.min.js"></script>
  </head>
  <body>
    <div id="app" class="app-container"></div>
    <script type="text/babel">
       var AppPackage = React.createClass({
        install: function() {
					$.ajax({
						 url: '/api/v1/apps/' + this.props.appId,
						 type: 'PUT',
						 success: function(response) {
							 console.log(response);
						 }.bind(this)
					});
				},
				render: function() {
					return (
						<div className="pure-u-1 pure-u-md-1-2 pure-u-lg-1-4">
							<h2>{this.props.name}</h2>
							<button class="pure-button" onClick={this.install}>Install</button>
						</div>
					);
				}
			}); 

      var AppServer = React.createClass({
        getInitialState: function() {
					return { apps: []};
				},

  			componentDidMount: function() {
					$.getJSON('/api/v1/apps', function(data) {
						this.setState({
							apps: data
 						});
          }.bind(this));
				},

				render: function() {
					var appPackages = this.state.apps.map(function(app) {
						return <AppPackage name={app.name} />;
					});

					return (
						<div className="pure-g">
							<div className="pure-u-1-1">
								<h1>crocoserver</h1>
                {appPackages}
							</div>
						</div>
					);
				}
      });

       ReactDOM.render(<AppServer />, document.getElementById('app'));
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.1.0/react.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.1.0/react-dom.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/zepto/1.1.6/zepto.min.js"></script>
  </body>
</html>
